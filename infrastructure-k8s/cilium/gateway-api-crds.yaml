# Gateway API CRDs Installation Reference
# ========================================
#
# This file documents the Gateway API CRDs required for Cilium Gateway API support.
# Gateway API provides a standard way to configure ingress and traffic routing.
#
# CRDs Installed:
#   - GatewayClass: Defines a class of Gateways (e.g., Cilium)
#   - Gateway: Defines the entry point for traffic
#   - HTTPRoute: Routes HTTP traffic to Services
#   - GRPCRoute: Routes gRPC traffic (experimental)
#   - ReferenceGrant: Allows cross-namespace references (experimental)
#   - BackendTLSPolicy: TLS configuration for backends (experimental)
#
# =============================================================================
# MANUAL INSTALLATION
# =============================================================================
#
# IMPORTANT: Install Gateway API CRDs BEFORE deploying Cilium Helm chart.
# Cilium's Gateway API controller requires these CRDs to be present.
#
# Install the experimental channel (required for full Cilium support):
#
#   kubectl apply --server-side -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.4.0/experimental-install.yaml
#
# Verify installation:
#
#   kubectl get crd gateways.gateway.networking.k8s.io
#   kubectl get crd httproutes.gateway.networking.k8s.io
#   kubectl get crd gatewayclasses.gateway.networking.k8s.io
#
# =============================================================================
# FLUX DEPLOYMENT (PHASE 7)
# =============================================================================
#
# For Flux GitOps deployment, create a Kustomization that fetches from upstream:
#
# apiVersion: kustomize.toolkit.fluxcd.io/v1
# kind: Kustomization
# metadata:
#   name: gateway-api-crds
#   namespace: flux-system
# spec:
#   interval: 1h
#   sourceRef:
#     kind: GitRepository
#     name: gateway-api
#   path: ./config/crd/experimental
#   prune: false  # Never prune CRDs
#   wait: true
#
# =============================================================================
# VERSION COMPATIBILITY
# =============================================================================
#
# Gateway API v1.4.0 is compatible with:
#   - Cilium v1.18.x
#   - Kubernetes v1.30+ (recommended)
#   - Kubernetes v1.27+ (minimum)
#
# Experimental channel includes:
#   - All standard channel resources (GatewayClass, Gateway, HTTPRoute)
#   - GRPCRoute for gRPC traffic routing
#   - ReferenceGrant for cross-namespace backend references
#   - BackendTLSPolicy for backend TLS configuration
#
# =============================================================================
# UPSTREAM REFERENCE
# =============================================================================
#
# Source: https://github.com/kubernetes-sigs/gateway-api
# Release: https://github.com/kubernetes-sigs/gateway-api/releases/tag/v1.4.0
# Documentation: https://gateway-api.sigs.k8s.io/
#
# =============================================================================
# WARNING
# =============================================================================
#
# - Do NOT delete Gateway API CRDs while Cilium is running
# - CRDs must be installed before Cilium Helm chart deployment
# - Use --server-side flag for clean CRD application
# - The experimental channel is required for GRPCRoute and ReferenceGrant
#
---
# Placeholder manifest for reference - actual CRDs are fetched from upstream URL
# This ensures the file can be used with kubectl apply for documentation purposes
apiVersion: v1
kind: Namespace
metadata:
  name: gateway-api-placeholder
  labels:
    app.kubernetes.io/name: gateway-api
    app.kubernetes.io/version: v1.4.0
  annotations:
    description: |
      This namespace is a placeholder to validate the manifest.
      Actual Gateway API CRDs should be installed from:
      https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.4.0/experimental-install.yaml
---
# To apply actual Gateway API CRDs, run:
# kubectl apply --server-side -f https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.4.0/experimental-install.yaml
